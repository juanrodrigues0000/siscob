
@{
    ViewBag.Title = "Listar";
}

<div class="tm-product-table-container">
    <table class="table table-hover tm-table-small tm-product-table">
        <thead>
            <h2 class="tm-block-title">Relação de Pagamentos</h2>
            <tr>
                <th scope="col">&nbsp;</th>
                <th scope="col">Valor Total da Parcela</th>
                <th scope="col">Status</th>
                <th scope="col">Data de Vencimento</th>
                <th scope="col">Id do Contrato</th>
                <th scope="col">id do Cliente</th>
                <th scope="col">&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var pagamento in ViewBag.PagamentoSet)
            {
            <tr>
                <th scope="col">&nbsp;</th>
                <td class="tm-product-name">@Convert.ToDouble(pagamento.ValorIntegralDaParcela)</td>
                <td>@pagamento.Status</td>
                <td>@pagamento.DataVencimento</td>
                <td>@pagamento.ContratoIdContrato</td>
                <td>@pagamento.ClienteIdCliente</td>
                <th scope="col">&nbsp;</th>
                <td>
                    <form action="#" method="post">
                        <input type="hidden" id="idpagamento" name="idpagamento" value="@pagamento.IdPagamento" />
                        <button onclick="quitarParcela()" class="tm-product-delete-link">
                            <i class="fas fa-check"></i>
                        </button>
                    </form>
                </td>

                <th scope="col">&nbsp;</th>
                <td>
                    <form action="/Pagamento/Details" method="post">
                        <input type="hidden" id="idpagamento" name="idpagamento" value="@pagamento.IdPagamento" />
                        <button type="submit" class="tm-product-delete-link">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </td>



                <td>
                    <form action="/Pagamento/Alterar" method="post">
                        <input type="hidden" id="idpagamento" name="idpagamento" value="@pagamento.IdPagamento" />
                        <button type="submit" class="tm-product-delete-link">
                            <i class="fas fa-pencil-alt"></i>
                        </button>
                    </form>
                </td>
                <td>
                    <form action="/Pagamento/Remover" method="post">
                        <input type="hidden" id="idpagamento" name="idpagamento" value="@pagamento.IdPagamento" />
                        <button type="submit" class="tm-product-delete-link">
                            <i class="far fa-trash-alt"></i>
                        </button>
                    </form>
                </td>

            </tr>
            }
        </tbody>
    </table>
</div>

<script type="text/javascript" src="~/Scripts/jquery-3.3.1.js"></script>
<script type="text/javascript">
    function quitarParcela() {
        var url = "@Url.Action("Quitar", "Pagamento")";
        $.post({
            url = url,
            data = { valorIntegralDaParcela: pgtoRealizado, status = 1 },
            sucess: atualiza
        });

    }
    function atualiza(pgtoRealizado, status)
    {
        var elemento = $("#pgtoRealizado", "#Status");
        elemento.html(pgtoRealizado, status);

    }

</script>